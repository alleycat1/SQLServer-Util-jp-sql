USE DemoDB
GO

/*
メモリ最適化テーブル用ファイルグループ
ALTER DATABASE [DemoDB] SET QUERY_STORE = OFF
GO
ALTER DATABASE [DemoDB] ADD FILEGROUP [InMemory] CONTAINS MEMORY_OPTIMIZED_DATA 
GO
ALTER DATABASE [DemoDB] ADD FILE ( NAME = N'DemoDB_InMemory', FILENAME = N'E:\data\DemoDB_InMemory' ) TO FILEGROUP [InMemory]
GO
*/

IF OBJECT_ID('HK_CI') IS NOT NULL
	DROP TABLE HK_CI

CREATE TABLE HK_CI(
	Col1 int IDENTITY PRIMARY KEY NONCLUSTERED,
	Col2 uniqueidentifier ,
	INDEX CCIX_HK_CI CLUSTERED COLUMNSTORE
) WITH (MEMORY_OPTIMIZED = ON, DURABILITY = SCHEMA_AND_DATA)
GO


SET NOCOUNT ON
GO
DECLARE @i int = 1
WHILE (@i <= 10000)
BEGIN
	INSERT INTO HK_CI(Col2) VALUES(NEWID())
	SET @i += 1
END
